<h1>Vdb Builder Workspace</h1>

<div class="container-fluid">
    <div class="row" ng-controller="VdbController">
        <div class="col-sm-2">

            <!-- Workspace -->

            <div class="row">
                <repo-widget></repo-widget>
            </div>

            <!-- End of Workspace -->

            <!-- Workspace Contents -->

            <div class="col-sm-12">
                <h4>Workspace Contents</h4>
            </div>

            <div id="panel-repo-content" class="col-sm-12">
                <accordion close-others="false">
                    <!-- -->
                    <!-- -->
                    <!-- Search Group -->
                    <!-- -->
                    <!-- -->
                    <accordion-group heading="Search" ng-init="searchIsOpen = true" is-open="searchIsOpen">
                        <accordion-heading>
                            Search
                            <!-- Necessary to make it into a dropdown as they do not refresh the page when clicked -->
                            <div class="pull-right" dropdown>
                                <button type="button" class="glyphicon glyphicon-save vdb-heading-btn" dropdown-toggle ng-click="searchOrbit.onSaveClicked($event)"></button>
                            </div>
                        </accordion-heading>
                        <form name="search" role="form">
                            <div class="input-group input-group-search">
                                <input  class="col-sm-12" type="text" class="form-control" ng-model="searchOrbit.searchTerms.contains"
                                            name="searchContainsElement" title="Search for all objects containing the search term">
                                <span class="vdb-search-span">
                                    <button type="submit" class="btn-search vdb-search-btn-search" ng-click="searchOrbit.submit()">
                                        Search<span class="glyphicon glyphicon-search vdb-search-btn-icon" aria-hidden="true"></span>
                                    </button>
                                </span>
                            </div>
                            <div id="advanced-search">
                                <h5><a ng-click="searchOrbit.advancedToggle = !searchOrbit.advancedToggle" href="#">Advanced</a></h5>
                            </div>
                            <div id="search-filters" class="well" ng-show="searchOrbit.advancedToggle">
                                <span>
                                    <label for="typeterm">Type</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.searchTerms.type" name="searchTypeElement" id="typeterm"
                                           title="Filter results to the given type">
                                </span>
                                <span>
                                    <label for="pathterm">Path</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.searchTerms.path" name="searchPathElement" id="pathterm"
                                           title="Search for a particular object by specifying its data path">
                                </span>
                                <span>
                                    <label for="parentterm">Parent</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.searchTerms.parent" name="searchParentElement" id="parentterm"
                                           title="Search for all descendents of a particular object by specifying its data path">
                                </span>
                                <span>
                                    <label for="nameterm">Name</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.searchTerms.objectName" name="searchParentElement" id="nameterm"
                                           title="Search for objects with a particular name (use '%' as a wildcard to broaden the search)">
                                </span>
                            </div>
                        </form>
                    </accordion-group>
                    <!-- -->
                    <!-- -->
                    <!-- Search Reports -->
                    <!-- -->
                    <!-- -->
                    <accordion-group ng-init="reportsIsOpen = true" is-open="reportsIsOpen">
                        <accordion-heading>
                            Search Reports
                            <!-- Necessary to make it into a dropdown as they do not refresh the page when clicked -->
                            <div class="pull-right" dropdown>
                                <button type="button" class="glyphicon glyphicon-remove vdb-heading-btn" dropdown-toggle ng-click="reportOrbit.onDeleteClicked($event)"></button>
                            </div>
                        </accordion-heading>
                        <input class="accordian-list-filter" type="text" ng-model="reportOrbit.searchFilter" placeholder="filter...">
                        <div class="list-group accordian-list">
                            <a class="list-group-item"
                               pagination-id="reports-paginate"
                                     dir-paginate="report in reportOrbit.reports|filter:reportOrbit.searchFilter|itemsPerPage:3"
                                     ng-click="$parent.reportOrbit.selectReport(report)" ng-class="{active:$parent.reportOrbit.reportSelected()==report}">
                                    {{report.name}}
                                </a>
                                <dir-pagination-controls pagination-id="reports-paginate" max-size="3" direction-links="true" boundary-links="true"></dir-pagination-controls>
                            </div>
                    </accordion-group>
                    <!-- -->
                    <!-- -->
                    <!-- Vdbs -->
                    <!-- -->
                    <!-- -->
                    <accordion-group heading="Vdbs">
                        <accordion-heading>
                            Vdbs
                            <!-- Necessary to make it into a dropdown as they do not refresh the page when clicked -->
                            <div class="pull-right" dropdown>
                                <button type="button" class="glyphicon glyphicon-plus vdb-heading-btn" dropdown-toggle ng-click="vdbOrbit.onAddClicked($event)"></button>
                                <button type="button" class="glyphicon glyphicon-minus vdb-heading-btn" dropdown-toggle ng-click="vdbOrbit.onRemoveClicked($event)"></button>
                            </div>
                        </accordion-heading>
                        <div id="list-vdb">
                            <input class="accordian-list-filter" type="text" ng-model="vdbOrbit.searchFilter" placeholder="filter...">
                            <div class="list-group accordian-list">
                                <a class="list-group-item"
                                     pagination-id="vdb-paginate"
                                     dir-paginate="vdb in vdbOrbit.vdbs|filter:vdbOrbit.searchFilter|orderBy:'keng__id'|itemsPerPage:3"
                                     ng-click="$parent.vdbOrbit.selectVdb(vdb)" ng-class="{active:$parent.vdbOrbit.vdbSelected()==vdb}">
                                    {{vdb.keng__id}}
                                </a>
                                <dir-pagination-controls pagination-id="vdb-paginate" max-size="3" direction-links="true" boundary-links="true"></dir-pagination-controls>
                            </div>
                            Total Vdbs: {{vdbOrbit.vdbs.length}}
                        </div>
                    </accordion-group>
                </accordion>

            </div>

            <!-- End of Workspace Contents -->
        </div>

        <!-- Panel for displaying the properties of the selection -->
        <div class=col-sm-10>

            <!-- Tab set for displaying selected vdb contents -->
            <!-- Only displayed is a vdb is selected in the vdbSelectionService -->
            <div ng-show="vdbOrbit.vdbSelected()">
                <tabset>
                    <tab heading="Vdb Content" ng-click="onTabSelected('Diagram')">
                        <div class="vdb-diagram col-sm-7">
                            <vdb-component-tree vdb-entry="vdbOrbit.vdbSelected()"
                                                              display-parents="false"
                                                              selected-vdb-component="vdbOrbit.selectedVdbComponent"
                                                              height="2048"
                                                              width="1024"
                                                              margin-left="120"
                                                              margin-right="120">
                            </vdb-component-tree>
                        </div>

                        <!-- Vertical tabbed page for displaying selected object properties -->
                        <div class="vdb-diagram-nav-col col-sm-5">
                            <divider-widget>
                                <divider title="New">
                                    <p>I am on the NEW page</p>
                                </divider>
                                <divider title="Properties">
                                    <div class="list-group">
                                        <div class="list-group-item" ng-repeat="component in vdbOrbit.selectedVdbComponent">
                                            <attribute-widget selected="component"/>
                                        </div>
                                    </div>
                                </divider>
                            </divider-widget>
                        </div>

                    </tab>
                    <tab heading="Vdb Preview" ng-click="vdbOrbit.onTabSelected('Preview')">
                        <ui-codemirror ng-model="vdbOrbit.vdbSelected().previewContent" ui-refresh="vdbOrbit.previewRefresh" ui-codemirror-opts="vdbOrbit.xmlPreviewOptions"></ui-codemirror>
                    </tab>
                </tabset>
            </div>

            <!-- Tab set for displaying the search results of the search made -->
            <!-- Only displayed if search button has been clicked -->
            <div class="vdb-search-results-pane" ng-show="searchOrbit.isVisible() == true">
                <div class="col-sm-4 vdb-search-results-panel">
                    <h4 class="vdb-search-results-title">Search Results</h4>
                    <input class="vdb-search-results-filter" type="text" ng-model="searchOrbit.searchFilter" placeholder="filter...">
                    <ul class="list-group pagination vdb-search-results-list">
                        <a class="list-group-item vdb-search-results-entry" href="#"
                             pagination-id="search-results-paginate"
                             dir-paginate="result in searchOrbit.results|orderBy:'keng__dataPath'|filter:searchOrbit.searchFilter|itemsPerPage:7 : 'search-results-paginate' track by $index"
                             ng-click="searchOrbit.setSelectedResult(result)" ng-class="{active:searchOrbit.selectedResult()==result}">
                            <h4 class="list-group-item-heading vdb-search-results-id">{{result.keng__id}}</h4>
                            <h4 class="list-group-item-heading vdb-search-results-type">{{result.keng__kType}}</h4>
                            <p class="list-group-item-text vdb-search-results-data-path">{{result.keng__dataPath}}</p>
                        </a>
                    </ul>
                    <dir-pagination-controls pagination-id="search-results-paginate" max-size="7" direction-links="true" boundary-links="true" ></dir-pagination-controls>
                </div>
                <div class="vdb-search-results-diagram col-sm-4">
                    <vdb-component-tree vdb-entry="searchOrbit.selectedResult()"
                                                      display-parents="true"
                                                      selected-vdb-component="searchOrbit.selectedVdbComponent"
                                                      orientation="searchOrbit.visOrientation"
                                                      height="550"
                                                      width="700">
                    </vdb-component-tree>
                </div>

                <!-- Vertical tabbed page for displaying selected object properties -->
                <div class="vdb-diagram-nav-col col-sm-4">
                    <divider-widget>
                        <divider title="Options">
                            <form action="" class="vdb-search-results-diagram-settings">
                                <label>Orientation:</label>
                                <br/>
                                <label class="block">
                                    <input type="radio" name="orientation" value="LR" ng-model="searchOrbit.visOrientation">
                                    Left-to-Right
                                </label>
                                <br/>
                                <label class="block">
                                    <input type="radio" name="orientation" value="TB" ng-model="searchOrbit.visOrientation" checked="checked">
                                    Top-to-Bottom
                                </label>
                            </form>
                        </divider>
                        <divider title="Properties">
                            <div class="list-group">
                                <div class="list-group-item" ng-repeat="component in searchOrbit.selectedVdbComponent">
                                    <attribute-widget selected="component"/>
                                </div>
                            </div>
                        </divider>
                    </divider-widget>
                </div>
        </div>
    </div>
</div>