<h1>Vdb Builder Workspace</h1>

<div class="container-fluid">
    <div class="row" ng-controller="VdbController">
        <div class="col-sm-2">

            <!-- Repository -->

            <div class="row">
                <repo-widget></repo-widget>
            </div>

            <!-- End of Repository -->

            <!-- Repository Contents -->

            <div class="col-sm-12">
                <h4>Repository Contents</h4>
            </div>

            <div id="panel-repo-content" class="col-sm-12">
                <accordion close-others="false">
                    <!-- -->
                    <!-- -->
                    <!-- Search Group -->
                    <!-- -->
                    <!-- -->
                    <accordion-group heading="Search" ng-init="searchIsOpen = true" is-open="searchIsOpen">
                        <form name="search" role="form">
                            <div class="input-group input-group-search">
                                <input  class="col-sm-12" type="text" class="form-control" ng-model="searchOrbit.containsTerm"
                                            name="searchContainsElement" required title="Search for all objects containing the search term">
                                <span class="vdb-search-span">
                                    <button class="btn-clear vdb-search-btn-clear" ng-click="searchOrbit.clear()">Clear</button>
                                    <button class="btn-search vdb-search-btn-search" ng-disabled="search.$invalid" ng-click="searchOrbit.submit()">
                                        Search<span class="glyphicon glyphicon-search vdb-search-btn-icon" aria-hidden="true"></span>
                                    </button>
                                </span>
                            </div>
                            <div id="advanced-search">
                                <h5><a ng-click="searchOrbit.advancedToggle = !searchOrbit.advancedToggle" href="#">Advanced</a></h5>
                            </div>
                            <div id="search-filters" class="well" ng-show="searchOrbit.advancedToggle">
                                <span>
                                    <label for="typeterm">Type</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.typeTerm" name="searchTypeElement" id="typeterm"
                                           title="Filter results to the given type">
                                </span>
                                <span>
                                    <label for="pathterm">Path</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.pathTerm" name="searchPathElement" id="pathterm"
                                           title="Search for a particular object by specifying its data path">
                                </span>
                                <span>
                                    <label for="parentterm">Parent</label>
                                    <input type="text" class="form-control" ng-model="searchOrbit.parentTerm" name="searchParentElement" id="parentterm"
                                           title="Search for all descendents of a particular object by specifying its data path">
                                </span>
                            </div>
                        </form>
                    </accordion-group>
                    <!-- -->
                    <!-- -->
                    <!-- Vdbs -->
                    <!-- -->
                    <!-- -->
                    <accordion-group heading="Vdbs" ng-init="vdbsIsOpen = true" is-open="vdbsIsOpen">
                        <accordion-heading>
                            Vdbs
                            <!-- Necessary to make it into a dropdown as they do not refresh the page when clicked -->
                            <div class="pull-right" dropdown>
                                <button type="button" class="glyphicon glyphicon-plus vdb-heading-btn" dropdown-toggle ng-click="onAddClicked($event)"></button>
                                <button type="button" class="glyphicon glyphicon-minus vdb-heading-btn" dropdown-toggle ng-click="onRemoveClicked($event)"></button>
                            </div>
                        </accordion-heading>
                        <div id="list-vdb">
                            <input class="vdbs-list-filter" type="text" ng-model="vdbOrbit.searchFilter" placeholder="filter...">
                            <div class="list-group vdbs-list">
                                <a class="list-group-item"
                                     pagination-id="vdb-paginate"
                                     dir-paginate="vdb in vdbOrbit.vdbs|filter:vdbOrbit.searchFilter|orderBy:'keng__id'|itemsPerPage:3"
                                     ng-click="$parent.vdbOrbit.selectVdb(vdb)" ng-class="{active:$parent.vdbOrbit.vdbSelected()==vdb}">
                                    {{vdb.keng__id}}
                                </a>
                                <dir-pagination-controls pagination-id="vdb-paginate" max-size="3" direction-links="true" boundary-links="true"></dir-pagination-controls>
                            </div>
                        </div>
                    </accordion-group>
                </accordion>

            </div>

            <!-- End of Repository Contents -->
        </div>

        <!-- Panel for displaying the properties of the selection -->
        <div class=col-sm-10>

            <!-- Tab set for displaying selected vdb contents -->
            <!-- Only displayed is a vdb is selected in the vdbSelectionService -->
            <div ng-show="vdbOrbit.vdbSelected()">
                <tabset>
                    <tab heading="Vdb Content" ng-click="onTabSelected('Diagram')">
                        <div class="vdb-diagram col-sm-7">
                            <vdb-visualization vdb="vdbOrbit.vdbSelected()" selected-vdb-component="vdbOrbit.selectedVdbComponent" height="2048" width="1024"></vdb-visualization>
                        </div>

                        <!-- Vertical tabbed page for displaying selected object properties -->
                        <div class="vdb-diagram-nav-col col-sm-5">
                            <divider-widget>
                                <divider title="New">
                                    <p>I am on the NEW page</p>
                                </divider>
                                <divider title="Properties">
                                    <div class="list-group">
                                        <div class="list-group-item" ng-repeat="component in vdbOrbit.selectedVdbComponent">
                                            <attribute-widget selected="component"/>
                                        </div>
                                    </div>
                                </divider>
                            </divider-widget>
                        </div>

                    </tab>
                    <tab heading="Vdb Preview" ng-click="vdbOrbit.onTabSelected('Preview')">
                        <ui-codemirror ng-model="vdbOrbit.vdbSelected().previewContent" ui-refresh="vdbOrbit.previewRefresh" ui-codemirror-opts="vdbOrbit.xmlPreviewOptions"></ui-codemirror>
                    </tab>
                </tabset>
            </div>

            <!-- Tab set for displaying the search results of the search made -->
            <!-- Only displayed if search button has been clicked -->
            <div class="vdb-search-results-pane" ng-show="searchOrbit.isVisible() == true">
                <div class="col-sm-4 vdb-search-results-panel">
                    <h4 class="vdb-search-results-title">Search Results</h4>
                    <input class="vdb-search-results-filter" type="text" ng-model="searchOrbit.searchFilter" placeholder="filter...">
                    <ul class="list-group pagination vdb-search-results-list">
                        <a class="list-group-item vdb-search-results-entry" href="#"
                             pagination-id="search-results-paginate"
                             dir-paginate="result in searchOrbit.results|filter:searchOrbit.searchFilter|orderBy:'keng__dataPath'|itemsPerPage:7"
                             ng-click="searchOrbit.setSelectedResult(result)" ng-class="{active:searchOrbit.selectedResult()==result}">
                            <h4 class="list-group-item-heading vdb-search-results-id">{{result.keng__id}}</h4>
                            <h4 class="list-group-item-heading vdb-search-results-type">{{result.keng__kType}}</h4>
                            <p class="list-group-item-text vdb-search-results-data-path">{{result.keng__dataPath}}</p>
                        </a>
                    </ul>
                    <dir-pagination-controls pagination-id="search-results-paginate" max-size="7" direction-links="true" boundary-links="true" ></dir-pagination-controls>
                </div>
                <div class="vdb-search-results-diagram col-sm-5">
                    <search-visualization search-entry="searchOrbit.selectedResult()"
                                                    selected-vdb-component="searchOrbit.selectedVdbComponent"
                                                    orientation="searchOrbit.visOrientation"
                                                    height="550"
                                                    width="700"></search-visualization>
                </div>

                <!-- Vertical tabbed page for displaying selected object properties -->
                <div class="vdb-diagram-nav-col col-sm-3">
                    <divider-widget>
                        <divider title="Options">
                            <form action="" class="vdb-search-results-diagram-settings">
                                <label>Orientation:</label>
                                <br/>
                                <label class="block">
                                    <input type="radio" name="orientation" value="LR" ng-model="searchOrbit.visOrientation">
                                    Left-to-Right
                                </label>
                                <br/>
                                <label class="block">
                                    <input type="radio" name="orientation" value="TB" ng-model="searchOrbit.visOrientation" checked="checked">
                                    Top-to-Bottom
                                </label>
                            </form>
                        </divider>
                        <divider title="Properties">
                            <div class="list-group">
                                <div class="list-group-item" ng-repeat="component in searchOrbit.selectedVdbComponent">
                                    <attribute-widget selected="component"/>
                                </div>
                            </div>
                        </divider>
                    </divider-widget>
                </div>
        </div>
    </div>
</div>